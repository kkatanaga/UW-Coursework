/* Copyright material for students taking COMP-2800 to work on assignment/labs/projects. */

package codesKK280;

import java.awt.BorderLayout;
import java.awt.GraphicsConfiguration;

import javax.swing.JFrame;
import javax.swing.JPanel;

import org.jogamp.java3d.*;
import org.jogamp.java3d.utils.universe.SimpleUniverse;
import org.jogamp.vecmath.*;


public class Lab5KK extends JPanel {

	private static final long serialVersionUID = 1L;
	private static JFrame frame;

	//===============/!\ Lab 5 shapes /!\===============
	public static RotationInterpolator rotate_Blades(int r_num, TransformGroup rotTG) {
		final BoundingSphere hundredBS = new BoundingSphere(new Point3d(), 100.0);
		rotTG.setCapability(TransformGroup.ALLOW_TRANSFORM_WRITE);
		Transform3D original = new Transform3D();
		rotTG.setTransform(original);
		Transform3D xAxis = new Transform3D();
		xAxis.rotZ(-Math.PI / 2.0);
		xAxis.mul(original);
		Alpha rotationAlpha = new Alpha(-1, r_num);
		RotationInterpolator rot_beh = new RotationInterpolator(rotationAlpha, rotTG, xAxis, 0.0f, (float) Math.PI * 2.0f);
		rot_beh.setSchedulingBounds(hundredBS);
		return rot_beh;
	}
	//===========/!\ End of Lab 5 shapes /!\============
	/* a function to build the content branch */
	public static BranchGroup create_Scene() {
		BranchGroup sceneBG = new BranchGroup();           // create the scene' BranchGroup
		TransformGroup sceneTG = new TransformGroup();     // create the scene's TransformGroup

		sceneTG.addChild(new FoundationShape().position_Object());	// Foundation
		sceneTG.addChild(new TowerShape().position_Object());		// Tower
		
		sceneTG.addChild(new YawDriveShape().position_Object());	// Yaw Drive
		sceneTG.addChild(new NacelleShape().position_Object());		// Nacelle
		
		sceneTG.addChild(new RotorShape().position_Object());		// Rotor			/!\ Lab 4 /!\
		TransformGroup bladeTG = (TransformGroup) new BladeShape().position_Object();
		sceneTG.addChild(rotate_Blades(5000, bladeTG));		// Rotor Blades		/!\ Lab 4 /!\
		sceneTG.addChild(bladeTG);
		
		sceneTG.addChild(new StringShape("KK's Lab5").position_Object());
		
		sceneBG.addChild(CommonsKK.add_Lights(CommonsKK.White, 1));	
//		sceneBG.addChild(CommonsKK.rotate_Behavior(7500, sceneTG));	
		sceneBG.addChild(sceneTG);                         // make 'sceneTG' continuous rotating
		sceneBG.addChild(new AxesShape().position_Object());			// /!\ Part of lab1; creates the x, y, z axes /!\
		return sceneBG;
	}

	/* NOTE: Keep the constructor for each of the labs and assignments */
	public Lab5KK(BranchGroup sceneBG) {
		GraphicsConfiguration config = SimpleUniverse.getPreferredConfiguration();
		Canvas3D canvas = new Canvas3D(config);
		
		SimpleUniverse su = new SimpleUniverse(canvas);    // create a SimpleUniverse
		CommonsKK.define_Viewer(su, new Point3d(4.0d, 0.0d, 1.0d));
		
		sceneBG.addChild(CommonsKK.key_Navigation(su));     // allow key navigation
		sceneBG.compile();		                           // optimize the BranchGroup
		su.addBranchGraph(sceneBG);                        // attach the scene to SimpleUniverse

		setLayout(new BorderLayout());
		add("Center", canvas);
		frame.setSize(800, 800);                           // set the size of the JFrame
		frame.setVisible(true);
	}

	public static void main(String[] args) {
		frame = new JFrame("KK's Lab5");
		frame.getContentPane().add(new Lab5KK(create_Scene()));  // create an instance of the class
		frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
	}
}
